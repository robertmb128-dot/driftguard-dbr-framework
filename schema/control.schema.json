{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "DriftGuard-DBR Control Schema",
  "type": "object",

  "properties": {

    "id": {
      "type": "string",
      "pattern": "^[A-Z]{2,5}-[0-9]{3}$"
    },

    "name": {
      "type": "string"
    },

    "category": {
      "type": "string"
    },

    "description": {
      "type": "string"
    },

    "severity": {
      "type": "string",
      "enum": ["Low", "Medium", "High", "Critical"]
    },

    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
    },

    "lifecycle_state": {
      "type": "string",
      "enum": ["Draft", "Approved", "Deprecated", "Retired"]
    },

    "review_frequency_days": {
      "type": "integer",
      "minimum": 30
    },

    "created_date": {
      "type": "string",
      "format": "date"
    },

    "last_reviewed": {
      "type": "string",
      "format": "date"
    },

    "remediation_guidance": {
      "type": "string"
    },

    "audit_notes": {
      "type": "string"
    }

  },

  "required": [
    "id",
    "name",
    "category",
    "description",
    "severity",
    "risk_weight"
    "version",
    "lifecycle_state",
    "review_frequency_days",
    "created_date",
    "last_reviewed"
  ],

  "additionalProperties": false
}
